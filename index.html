<!DOCTYPE html>
<html lang="am">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>áŠ¥áˆá‹µáŠ• á‰ áá‰…áˆ­ - Edir Digital Pro</title>
    <!-- SDKs -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Ethiopic:wght@100..900&family=Inter:wght@400;700;900&display=swap" rel="stylesheet">

    <style>
        :root {
            --tg-bg: var(--tg-theme-bg-color, #f8fafc);
            --tg-secondary-bg: var(--tg-theme-secondary-bg-color, #ffffff);
            --tg-text: var(--tg-theme-text-color, #0f172a);
            --brand-green: #15803d;
            --card-border: rgba(226, 232, 240, 0.8);
        }
        body {
            background-color: var(--tg-bg);
            color: var(--tg-text);
            font-family: 'Noto Sans Ethiopic', 'Inter', sans-serif;
            margin: 0; padding: 0;
        }
        .section-card {
            background-color: var(--tg-secondary-bg);
            border: 1px solid var(--card-border);
            border-radius: 1.5rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .input-style {
            background-color: var(--tg-bg);
            border: 2px solid var(--card-border);
            border-radius: 1rem;
            padding: 1rem;
            width: 100%;
            font-size: 16px;
            color: var(--tg-text);
        }
        .method-card {
            border: 2px solid var(--card-border);
            border-radius: 1.5rem;
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: 0.3s;
        }
        .method-card.selected {
            border-color: var(--brand-green);
            background-color: rgba(21, 128, 61, 0.1);
        }
        .tab-btn { padding: 12px; border-radius: 12px; font-weight: 800; font-size: 12px; color: rgba(255,255,255,0.6); }
        .active-tab { color: white; background: rgba(255,255,255,0.2); }
    </style>
</head>
<body class="p-4">

    <header class="flex items-center justify-between mb-6">
        <div class="flex items-center gap-3">
            <div class="w-10 h-10 bg-green-700 rounded-xl flex items-center justify-center text-xl shadow-lg">ğŸ¡</div>
            <h1 class="text-sm font-black uppercase">áŠ¥áˆá‹µáŠ• á‰ áá‰…áˆ­</h1>
        </div>
        <span id="userName" class="text-xs font-bold opacity-70">áŠ á‰£áˆ</span>
    </header>

    <nav id="mainNav" class="bg-green-700 p-1.5 rounded-2xl grid grid-cols-4 gap-1 mb-8">
        <button onclick="showTab('payment')" id="payTab" class="tab-btn active-tab">áŠ­áá‹«</button>
        <button onclick="showTab('status')" id="statTab" class="tab-btn">áˆáŠ”á‰³</button>
        <button onclick="showTab('loan')" id="loanTab" class="tab-btn">á‰¥á‹µáˆ­</button>
        <button onclick="showTab('help')" id="helpTab" class="tab-btn">áŠ¥áˆ­á‹³á‰³</button>
    </nav>

    <!-- Payment Section (Kutaa Kafaltii) -->
    <div id="paymentSection" class="animate-section">
        <form id="paymentForm" class="space-y-4">
            <!-- Payer Selection (Eenyu akka kaffalu filachuu) -->
            <div class="section-card space-y-4">
                <h3 class="text-[11px] font-black uppercase opacity-50 tracking-widest">áŠ­áá‹«á‹ áˆˆáˆ›áŠ• áŠá‹?</h3>
                <div class="grid grid-cols-2 gap-3">
                    <div id="selfPay" class="method-card selected" onclick="togglePayer('self')">
                        <span class="text-xl block mb-1">ğŸ™‹â€â™‚ï¸</span>
                        <span class="text-[10px] font-bold uppercase">áˆˆáŠ¥áŠ”</span>
                    </div>
                    <div id="otherPay" class="method-card" onclick="togglePayer('other')">
                        <span class="text-xl block mb-1">ğŸ‘¥</span>
                        <span class="text-[10px] font-bold uppercase">áˆˆáˆŒáˆ‹ áˆ°á‹</span>
                    </div>
                </div>

                <div id="otherMemberBox" class="hidden animate-section mt-4 space-y-2">
                    <label class="text-[10px] font-black uppercase opacity-50">á‹¨áŠ á‰£áˆ‰ áˆµáˆ/Username</label>
                    <input type="text" id="targetMember" placeholder="@username á‹ˆá‹­áˆ áˆ™áˆ‰ áˆµáˆ" class="input-style">
                </div>
            </div>

            <div class="section-card space-y-4">
                <div class="space-y-2">
                    <label class="text-[10px] font-black uppercase opacity-50">á‹¨áŠ­áá‹« á‹“á‹­áŠá‰µ</label>
                    <select id="purpose" class="input-style">
                        <option value="áˆ˜á‹°á‰ áŠ› áˆ˜á‹‹áŒ®">áˆ˜á‹°á‰ áŠ› áˆ˜á‹‹áŒ®</option>
                        <option value="á‹¨á‰¥á‹µáˆ­ áˆ˜áˆ˜áˆˆáˆ»">á‹¨á‰¥á‹µáˆ­ áˆ˜áˆ˜áˆˆáˆ»</option>
                        <option value="á‹¨á‰…áŒ£á‰µ áŠ­áá‹«">á‹¨á‰…áŒ£á‰µ áŠ­áá‹«</option>
                    </select>
                </div>

                <div class="space-y-2">
                    <label class="text-[10px] font-black uppercase opacity-50">á‹¨áŠ­áá‹« á‹ˆáˆ­/áŒŠá‹œ</label>
                    <select id="period" class="input-style">
                        <option value="áˆ˜áˆµáŠ¨áˆ¨áˆ">áˆ˜áˆµáŠ¨áˆ¨áˆ</option><option value="áŒ¥á‰…áˆá‰µ">áŒ¥á‰…áˆá‰µ</option>
                        <option value="áˆ…á‹³áˆ­">áˆ…á‹³áˆ­</option><option value="á‰³áˆ…áˆ³áˆµ">á‰³áˆ…áˆ³áˆµ</option>
                        <option value="áŒ¥áˆ­">áŒ¥áˆ­</option><option value="á‹¨áŠ«á‰²á‰µ">á‹¨áŠ«á‰²á‰µ</option>
                        <option value="áˆ˜áŒ‹á‰¢á‰µ">áˆ˜áŒ‹á‰¢á‰µ</option><option value="áˆšá‹«á‹á‹«">áˆšá‹«á‹á‹«</option>
                        <option value="áŒáŠ•á‰¦á‰µ">áŒáŠ•á‰¦á‰µ</option><option value="áˆ°áŠ”">áˆ°áŠ”</option>
                        <option value="áˆáˆáˆŒ">áˆáˆáˆŒ</option><option value="áŠáˆáˆ´">áŠáˆáˆ´</option>
                    </select>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div class="space-y-2">
                        <label class="text-[10px] font-black uppercase opacity-50">áˆ˜áŒ áŠ• (á‰¥áˆ­)</label>
                        <input type="number" id="amount" placeholder="0.00" required class="input-style text-green-700 font-bold">
                    </div>
                    <div class="space-y-2">
                        <label class="text-[10px] font-black uppercase opacity-50">á‰…áŒ£á‰µ (á‰¥áˆ­)</label>
                        <input type="number" id="penalty" value="0" class="input-style text-red-600 font-bold">
                    </div>
                </div>
            </div>

            <div class="section-card space-y-4">
                <h3 class="text-[11px] font-black uppercase opacity-50 tracking-widest">á‹¨áŠ­áá‹« áˆ˜áŠ•áŒˆá‹µ</h3>
                <div class="grid grid-cols-2 gap-3">
                    <div id="mManual" class="method-card selected" onclick="setMode('manual')">ğŸ§¾ á‰ á‹°áˆ¨áˆ°áŠ</div>
                    <div id="mEasy" class="method-card" onclick="setMode('easypay')">ğŸ’³ á‹²áŒ‚á‰³áˆ</div>
                </div>
            </div>

            <button type="submit" class="w-full py-4 bg-green-700 text-white rounded-2xl font-black shadow-xl active:scale-95 transition-all">
                áˆ˜áˆ¨áŒƒá‹áŠ• áˆ‹áŠ­
            </button>
        </form>
    </div>

    <!-- Placeholder for other sections (Bakka kutaawwan biroo) -->
    <div id="statusSection" class="hidden animate-section p-4 text-center">
        <h2 class="text-xl font-bold">á‹¨áˆáŠ”á‰³ áˆ˜áŠ¨á‰³á‰°á‹«</h2>
        <p class="opacity-60 mt-2">áŠ¥á‹šáˆ… áŒ‹áˆ­ á‹¨áŠ­áá‹« áˆáŠ”á‰³á‹áŠ• áˆ›á‹¨á‰µ á‹­á‰½áˆ‹áˆ‰á¢</p>
    </div>

    <div id="loanSection" class="hidden animate-section p-4 text-center">
        <h2 class="text-xl font-bold">á‹¨á‰¥á‹µáˆ­ áŠ áŒˆáˆáŒáˆá‰µ</h2>
        <p class="opacity-60 mt-2">á‹­áˆ… áŠ áŒˆáˆáŒáˆá‰µ á‰ á‰…áˆ­á‰¡ á‹­áŒ€áˆáˆ«áˆá¢</p>
    </div>

    <div id="helpSection" class="hidden animate-section p-4 text-center">
        <h2 class="text-xl font-bold">áŠ¥áˆ­á‹³á‰³</h2>
        <p class="opacity-60 mt-2">á‰½áŒáˆ­ áŠ«áŒ‹áŒ áˆ˜á‹á‰µ áŠ áˆµá‰°á‹³á‹³áˆªá‹áŠ• á‹«áŠáŒ‹áŒáˆ©á¢</p>
    </div>

    <script>
        // Init Telegram WebApp (App-icha Telegram jalqabuu)
        const tg = window.Telegram.WebApp;
        tg.ready();
        
        let payerMode = 'self';
        let payMode = 'manual';

        // Function to switch tabs (Kutaawwan gidduu deemuu)
        window.showTab = (tabName) => {
            const sections = ['payment', 'status', 'loan', 'help'];
            const tabs = {
                'payment': 'payTab',
                'status': 'statTab',
                'loan': 'loanTab',
                'help': 'helpTab'
            };

            sections.forEach(s => {
                const element = document.getElementById(s + 'Section');
                const btn = document.getElementById(tabs[s]);
                if (element) {
                    element.classList.toggle('hidden', s !== tabName);
                }
                if (btn) {
                    btn.classList.toggle('active-tab', s === tabName);
                }
            });
            
            if (tg.HapticFeedback) tg.HapticFeedback.impactOccurred('light');
        };

        // Toggle Payer (Eenyu akka kaffalu jijjiiruu)
        window.togglePayer = (mode) => {
            payerMode = mode;
            document.getElementById('selfPay').classList.toggle('selected', mode === 'self');
            document.getElementById('otherPay').classList.toggle('selected', mode === 'other');
            document.getElementById('otherMemberBox').classList.toggle('hidden', mode === 'self');
        };

        // Set Payment Mode (Akkaataa kaffaltii)
        window.setMode = (m) => {
            payMode = m;
            document.getElementById('mManual').classList.toggle('selected', m === 'manual');
            document.getElementById('mEasy').classList.toggle('selected', m === 'easypay');
        };

        // Handle Form Submission (Deetaa erguu)
        document.getElementById('paymentForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const payload = {
                type: 'payment_report',
                gateway: payMode,
                purpose: document.getElementById('purpose').value,
                period: document.getElementById('period').value,
                amount: document.getElementById('amount').value,
                penalty: document.getElementById('penalty').value,
                payFor: payerMode === 'self' ? 'self' : document.getElementById('targetMember').value
            };
            tg.sendData(JSON.stringify(payload));
            tg.close();
        });

        // Set Username in header
        if(tg.initDataUnsafe?.user) {
            document.getElementById('userName').innerText = tg.initDataUnsafe.user.first_name;
        }
    </script>
</body>
</html>
